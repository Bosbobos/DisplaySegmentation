# Программа для обучения и использования нейронной сети с целью выполнения задачи сегментации экранов на изображениях

Программа подготовлена студентом БИБ233 МИЭМ НИУ ВШЭ Коноваловым Матвеем

## Установка необходимых зависимостей

1. Установите Python (работа программы проверялась на Python 3.13)

2. Установите pytorch:

   2.1. Если проект будет запускаться на видеокарте Nvidia, то установите Cuda и соответствующую ей версию pytorch

   2.2. Если проект будет запускаться на процессоре, то установите pytorch командой `pip install torch`

3. Установите остальные необходимые зависимости командой `pip install -r requirements.txt`

## Использование готовой модели

1. Скачайте модель по [ссылке](https://disk.yandex.ru/d/ZL3wXr_WoFsoCQ)

2. Поместите её в папку checkpoints, чтобы получился путь checkpoints/segformer_mit_b4_epoch70.pth

3. Поместите изображения, требующие сегментации, в папку test_images (если папка не существует, создайте её)

4. Запустите файл predict.py командой `python predict.py`

5. Получившиеся маски будут находиться в директории generated_masks

6. Маски можно наложить на изображения командой `python OverlayMask.py`

7. Наложенные маски можно найти в директории overlayed_masks

## Обучение модели с нуля

1. Используйте собственный датасет, либо скачайте его командой `python GetDataset.py`

2. Датасет должен находиться в папках coco_tv_images, маски к нему - в coco_tv_masks

3. Отфильтруйте датасет командой `python FindValidMasks.py`

4. Можно начинать обучение командой `python train.py`

5. Готовые модели будут находиться в папке checkpoints
